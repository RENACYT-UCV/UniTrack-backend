<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Escáner QR desde Laptop</title>
    <script
      src="https://unpkg.com/html5-qrcode"
      type="text/javascript"
    ></script>
    <style>
      body {
        font-family: sans-serif;
        text-align: center;
        margin-top: 40px;
      }
      #reader {
        width: 320px;
        margin: auto;
      }
      #resultado {
        margin-top: 20px;
        color: green;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h2>Escanea el Código QR desde tu Laptop</h2>
    <div id="reader"></div>
    <p id="resultado">Esperando escaneo...</p>

    <!-- descomentar todo el script si deseas verificar el hash -->
    <!-- <script>
    function onScanSuccess(qrMessage) {
      document.getElementById('resultado').innerText = "codigo escaneado es: " + qrMessage;

      // Enviar al backend
      // Descomentar la siguiente sección si deseas que el QR se verifique con el backend Nest.js
      // Reemplazar localhost con la IP del backend si se prueba desde otro dispositivo
      fetch('http://localhost:3000/qr/verificar', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ hash: qrMessage })//debe coincidir con el nombre del dto
      })
      .then(res => res.json())
      .then(data => {
        console.log("Código QR escaneado:", data);
        alert("Código QR escaneado correctamente.");
      })
      .catch(err => {
        console.error("Error al escanear:", err);
      });

      html5QrCode.stop();
    }

    const html5QrCode = new Html5Qrcode("reader");
    html5QrCode.start(
      { facingMode: "environment" },
      { fps: 10, qrbox: 250 },
      onScanSuccess
    );
  </script> -->
  </body>
</html>
